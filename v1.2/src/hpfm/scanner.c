#include "hpfm.tab.h"

#define MAXRW 314
#define MAXRWLEN 20

char rwnames[MAXRW][MAXRWLEN] = {
        "IN",
        "IF",
        "DO",
        "GO",
        "TO",
        "NO",
        "REC",
        "EOR",
        "OUT",
        "EQV",
        "LEN",
        "END",
        "NEW",
        "INT",
        "MAX",
        "MIN",
        "MOD",
        "COS",
        "EXP",
        "LOG",
        "ERR",
        "FMT",
        "USE",
        "PAD",
        "HPF",
        "NML",
        "SIN",
        "TAN",
        "LGE",
        "LGT",
        "LLE",
        "LLT",
        "IOR",
        "ALL",
        "ANY",
        "RAV",
        "IOTA",
        "IALL",
        "IEOR",
        "PACK",
        "ILEN",
        "SCAN",
        "TRIM",
        "TANH",
        "SINH",
        "SQRT",
        "CHAR",
        "HUGE",
        "TINY",
        "IAND",
        "UNIT",
        "FILE",
        "FORM",
        "RECL",
        "SIZE",
        "ONLY",
        "CALL",
        "OPEN",
        "COSH",
        "NINT",
        "SIGN",
        "ACOS",
        "ASIN",
        "ATAN",
        "WITH",
        "PURE",
        "ONTO",
        "TYPE",
        "TRUE",
        "KIND",
        "MASK",
        "ELSE",
        "READ",
        "NONE",
        "THEN",
        "EXIT",
        "REAL",
        "SAVE",
        "DATA",
        "LIST",
        "STAT",
        "CASE",
        "STOP",
        "WHILE",
        "PAUSE",
        "WHERE",
        "PRINT",
        "NAMED",
        "FALSE",
        "POWER",
        "TIMES",
        "INOUT",
        "CYCLE",
        "ALIGN",
        "LOG10",
        "DPROD",
        "FLOOR",
        "ATAN2",
        "BLANK",
        "DELIM",
        "WRITE",
        "ENTRY",
        "BLOCK",
        "CLOSE",
        "EXIST",
        "SCALE",
        "BTEST",
        "IBCLR",
        "IBITS",
        "RADIX",
        "RANGE",
        "ACHAR",
        "ICHAR",
        "INDEX",
        "MERGE",
        "IBSET",
        "ISHFT",
        "COUNT",
        "LEADZ",
        "PARITY",
        "POPCNT",
        "POPPAR",
        "MAXVAL",
        "MINVAL",
        "ISHFTC",
        "MVBITS",
        "SPREAD",
        "UBOUND",
        "LBOUND",
        "UNPACK",
        "MAXLOC",
        "MINLOC",
        "IACHAR",
        "REPEAT",
        "VERIFY",
        "DIGITS",
        "DIRECT",
        "MODULE",
        "RESULT",
        "ACCESS",
        "NUMBER",
        "MODULO",
        "CYCLIC",
        "FORALL",
        "ASSIGN",
        "DSLASH",
        "PUBLIC",
        "DCOLON",
        "INTENT",
        "FORMAT",
        "IOSTAT",
        "STATUS",
        "ACTION",
        "REWIND",
        "OPENED",
        "TARGET",
        "COMMON",
        "SELECT",
        "DOUBLE",
        "COMPLEX",
        "POINTER",
        "INTEGER",
        "LOGICAL",
        "DEFAULT",
        "NULLIFY",
        "UNKNOWN",
        "PRIVATE",
        "INHERIT",
        "ADVANCE",
        "INQUIRE",
        "NEXTREC",
        "PROGRAM",
        "ENDFILE",
        "DYNAMIC",
        "EPSILON",
        "ADJUSTL",
        "ADJUSTR",
        "SPACING",
        "NEAREST",
        "REVERSE",
        "RESHAPE",
        "GRADE_UP",
        "TRANSFER",
        "LEN_TRIM",
        "EXPONENT",
        "FRACTION",
        "BIT_SIZE",
        "FUNCTION",
        "CONTAINS",
        "OPERATOR",
        "TEMPLATE",
        "REALLIGN",
        "EXTERNAL",
        "SEQUENCE",
        "IMPLICIT",
        "OPTIONAL",
        "LEFTCONS",
        "CONTINUE",
        "RIGHTCONS",
        "PARAMETER",
        "LEFTPAREN",
        "DIMENSION",
        "INTRINSIC",
        "PERCISION",
        "CHARACTER",
        "ELSEWHERE",
        "POISITION",
        "READWRITE",
        "EXTRINSIC",
        "HPF_LOCAL",
        "PROCEDURE",
        "BACKSPACE",
        "FORMATTED",
        "INTERFACE",
        "RECURSIVE",
        "PRECISION",
        "RRSPACING",
        "ALLOCATED",
        "CAT_PARTS",
        "SUM_PARTS",
        "SUM_PREFIX",
        "SUM_SUFFIX",
        "ASSOCIATED",
        "ALL_PREFIX",
        "ALL_SUFFIX",
        "ANY_PREFIX",
        "ANY_SUFFIX",
        "GRADE_DOWN",
        "SEQUENTIAL",
        "UNFORMATED",
        "ASSIGNMENT",
        "SUBROUTINE",
        "PROCESSORS",
        "DISTRIBUTE",
        "RIGHTPAREN",
        "DEALLOCATE",
        "EQUIVALENCE",
        "ALLOCATABLE",
        "INDEPENDENT",
        "MAXEXPONENT",
        "MINEXPONENT",
        "IALL_PREFIX",
        "IANY_PREFIX",
        "IANY_SUFFIX",
        "SUM_SCATTER",
        "INDEX_PARTS",
        "ALL_SCATTER",
        "ANY_SCATTER",
        "COPY_PREFIX",
        "COPY_SUFFIX",
        "RANDOM_SEED",
        "REDISTRIBUTE",
        "CSHIFT_PARTS",
        "IALL_SCATTER",
        "ICALL_SUFFIX",
        "IANY_SCATTER",
        "SYSTEM_CLOCK",
        "HPF_TEMPLATE",
        "COUNT_SUFFIX",
        "COPY_SCATTER",
        "COUNT_PREFIX",
        "SET_EXPONENT",
        "MAXVAL_PREFIX",
        "MAXVAL_SUFFIX",
        "PARITY_PREFIX",
        "PARITY_SUFFIX",
        "REVERSE_PARTS",
        "PRODUCT_PARTS",
        "COUNT_SCATTER",
        "DATE_AND_TIME",
        "RANDOM_NUMBER",
        "HPF_ALLIGNMENT",
        "PRODUCT_PREFIX",
        "PRODUCT_SUFFIX",
        "PARITY_SCATTER",
        "IPARITY_PREFIX",
        "IPARITY_SUFFIX",
        "MAXVAL_SCATTER",
        "IPARITY_SCATTER",
        "TRANSPOSE_PARTS",
        "PRODUCT_SCATTER",
        "HPF_DISTRIBUTION",
        "PROCESSORS_SHAPE",
        "SELECTED_INT_KIND",
        "SELECTED_REAL_KIND",
        "NUMBER_OF_PROCESSORS"
};

int rwtokens[MAXRW] = {
        IN1,
        IF1,
        DO1,
        GO1,
        TO1,
        NO1,
        REC1,
        EOR1,
        OUT1,
        EQV1,
        LEN1,
        END1,
        NEW1,
        INT1,
        MAX1,
        MIN1,
        MOD1,
        COS1,
        EXP1,
        LOG1,
        ERR1,
        FMT1,
        USE1,
        PAD1,
        HPF1,
        NML1,
        SIN1,
        TAN1,
        LGE1,
        LGT1,
        LLE1,
        LLT1,
        IOR1,
        ALL1,
        ANY1,
        RAV1,
        IOTA1,
        IALL1,
        IEOR1,
        PACK1,
        ILEN1,
        SCAN1,
        TRIM1,
        TANH1,
        SINH1,
        SQRT1,
        CHAR1,
        HUGE1,
        TINY1,
        IAND1,
        UNIT1,
        FILE1,
        FORM1,
        RECL1,
        SIZE1,
        ONLY1,
        CALL1,
        OPEN1,
        COSH1,
        NINT1,
        SIGN1,
        ACOS1,
        ASIN1,
        ATAN1,
        WITH1,
        PURE1,
        ONTO1,
        TYPE1,
        TRUE1,
        KIND1,
        MASK1,
        ELSE1,
        READ1,
        NONE1,
        THEN1,
        EXIT1,
        REAL1,
        SAVE1,
        DATA1,
        LIST1,
        STAT1,
        CASE1,
        STOP1,
        WHILE1,
        PAUSE1,
        WHERE1,
        PRINT1,
        NAMED1,
        FALSE1,
        POWER1,
        TIMES1,
        INOUT1,
        CYCLE1,
        ALIGN1,
        LOG101,
        DPROD1,
        FLOOR1,
        ATAN21,
        BLANK1,
        DELIM1,
        WRITE1,
        ENTRY1,
        BLOCK1,
        CLOSE1,
        EXIST1,
        SCALE1,
        BTEST1,
        IBCLR1,
        IBITS1,
        RADIX1,
        RANGE1,
        ACHAR1,
        ICHAR1,
        INDEX1,
        MERGE1,
        IBSET1,
        ISHFT1,
        COUNT1,
        LEADZ1,
        PARITY1,
        POPCNT1,
        POPPAR1,
        MAXVAL1,
        MINVAL1,
        ISHFTC1,
        MVBITS1,
        SPREAD1,
        UBOUND1,
        LBOUND1,
        UNPACK1,
        MAXLOC1,
        MINLOC1,
        IACHAR1,
        REPEAT1,
        VERIFY1,
        DIGITS1,
        DIRECT1,
        MODULE1,
        RESULT1,
        ACCESS1,
        NUMBER1,
        MODULO1,
        CYCLIC1,
        FORALL1,
        ASSIGN1,
        DSLASH1,
        PUBLIC1,
        DCOLON1,
        INTENT1,
        FORMAT1,
        IOSTAT1,
        STATUS1,
        ACTION1,
        REWIND1,
        OPENED1,
        TARGET1,
        COMMON1,
        SELECT1,
        DOUBLE1,
        COMPLEX1,
        POINTER1,
        INTEGER1,
        LOGICAL1,
        DEFAULT1,
        NULLIFY1,
        UNKNOWN1,
        PRIVATE1,
        INHERIT1,
        ADVANCE1,
        INQUIRE1,
        NEXTREC1,
        PROGRAM1,
        ENDFILE1,
        DYNAMIC1,
        EPSILON1,
        ADJUSTL1,
        ADJUSTR1,
        SPACING1,
        NEAREST1,
        REVERSE1,
        RESHAPE1,
        GRADE_UP1,
        TRANSFER1,
        LEN_TRIM1,
        EXPONENT1,
        FRACTION1,
        BIT_SIZE1,
        FUNCTION1,
        CONTAINS1,
        OPERATOR1,
        TEMPLATE1,
        REALLIGN1,
        EXTERNAL1,
        SEQUENCE1,
        IMPLICIT1,
        OPTIONAL1,
        LEFTCONS1,
        CONTINUE1,
        RIGHTCONS1,
        PARAMETER1,
        LEFTPAREN1,
        DIMENSION1,
        INTRINSIC1,
        PERCISION1,
        CHARACTER1,
        ELSEWHERE1,
        POISITION1,
        READWRITE1,
        EXTRINSIC1,
        HPF_LOCAL1,
        PROCEDURE1,
        BACKSPACE1,
        FORMATTED1,
        INTERFACE1,
        RECURSIVE1,
        PRECISION1,
        RRSPACING1,
        ALLOCATED1,
        CAT_PARTS1,
        SUM_PARTS1,
        SUM_PREFIX1,
        SUM_SUFFIX1,
        ASSOCIATED1,
        ALL_PREFIX1,
        ALL_SUFFIX1,
        ANY_PREFIX1,
        ANY_SUFFIX1,
        GRADE_DOWN1,
        SEQUENTIAL1,
        UNFORMATED1,
        ASSIGNMENT1,
        SUBROUTINE1,
        PROCESSORS1,
        DISTRIBUTE1,
        RIGHTPAREN1,
        DEALLOCATE1,
        EQUIVALENCE1,
        ALLOCATABLE1,
        INDEPENDENT1,
        MAXEXPONENT1,
        MINEXPONENT1,
        IALL_PREFIX1,
        IANY_PREFIX1,
        IANY_SUFFIX1,
        SUM_SCATTER1,
        INDEX_PARTS1,
        ALL_SCATTER1,
        ANY_SCATTER1,
        COPY_PREFIX1,
        COPY_SUFFIX1,
        RANDOM_SEED1,
        REDISTRIBUTE1,
        CSHIFT_PARTS1,
        IALL_SCATTER1,
        ICALL_SUFFIX1,
        IANY_SCATTER1,
        SYSTEM_CLOCK1,
        HPF_TEMPLATE1,
        COUNT_SUFFIX1,
        COPY_SCATTER1,
        COUNT_PREFIX1,
        SET_EXPONENT1,
        MAXVAL_PREFIX1,
        MAXVAL_SUFFIX1,
        PARITY_PREFIX1,
        PARITY_SUFFIX1,
        REVERSE_PARTS1,
        PRODUCT_PARTS1,
        COUNT_SCATTER1,
        DATE_AND_TIME1,
        RANDOM_NUMBER1,
        HPF_ALLIGNMENT1,
        PRODUCT_PREFIX1,
        PRODUCT_SUFFIX1,
        PARITY_SCATTER1,
        IPARITY_PREFIX1,
        IPARITY_SUFFIX1,
        MAXVAL_SCATTER1,
        IPARITY_SCATTER1,
        TRANSPOSE_PARTS1,
        PRODUCT_SCATTER1,
        HPF_DISTRIBUTION1,
        PROCESSORS_SHAPE1,
        SELECTED_INT_KIND1,
        SELECTED_REAL_KIND1,
        NUMBER_OF_PROCESSORS1
};

int rwidxtab [MAXRWLEN+2] = { 0, 0, 0, 13, 48, 98, 139, 182, 207, 224, 247,
  263, 279, 290, 299, 306, 309, 311, 312, 313, 313, 314 };
 
int check_reserved (char *name)
{
  int length;
  int i, j;
 
  length = strlen (name);
  printf ("length %d\n", length);
  if (length > MAXRWLEN) {
    return NAME1;
  } else {
    for (i = rwidxtab[length], j = rwidxtab[length+1];
      (i < j) && (strcmp (rwnames[i], name) != 0); i++) {}
    if (i == j) {
      printf ("returning name\n");
      return NAME1;
    } else {
      printf ("returning token\n");
      return (rwtokens[i]);
    }
  }
}

	ALL1,
	ANY1,
	IOR1,
        ABS1,
        SUM1,
        DIM1,
	INT1,
	MAX1,
	MIN1,
	MOD1,
	LOG1,
	COS1,
	EXP1,
	SIN1,
	TAN1,
	LGE1,
	LGT1,
	LLE1,
	LLT1,
	SCAN1,
	TRIM1,
	TINY1,
	HUGE1,
	SINH1,
	SQRT1,
	COSH1,
	NINT1,
	SIGN1,
	ACOS1,
	ASIN1,
	ATAN1,
        AINT1,
        DBLE1,
	TANH1,
	CHAR1,
	PACK1,
	IAND1,
	IEOR1,
	IBCLR1,
	BTEST1,
	IBITS1,
	IBSET1,
	ISHFT1,
	MERGE1,
        CMPLX1,
        CONJG1,
	COUNT1,
	ACHAR1,
	ICHAR1,
	INDEX1,
	ATAN21,
        ANINT1,
        AIMAG1,
        SHAPE1,
	DPROD1,
	FLOOR1,
        LOG101,
	RADIX1,
	SCALE1,
	RANGE1,
	REPEAT1,
	VERIFY1,
	DIGITS1,
	MODULO1,
	IACHAR1,
	MAXVAL1,
	MVBITS1,
        CONCAT1,
        CSHIFT1,
        MATMUL1,
	MINVAL1,
	LBOUND1,
	UBOUND1,
	MAXLOC1,
	MINLOC1,
	SPREAD1,
	UNPACK1,
	ISHFTC1,
	SPACING1,
	RESHAPE1,
        PRODUCT1,
        CEILING1,
        EOSHIFT1,
	ADJUSTL1,
	ADJUSTR1,
	EPSILON1,
	NEAREST1,
	LEN_TRIM1,
	EXPONENT1,
	FRACTION1,
	BIT_SIZE1,
	TRANSFER1,
	RRSPACING1,
	PRECISION1,
	ALLOCATED1,
        TRANSPOSE1,
	ASSOCIATED1,
	MAXEXPONENT1,
	MINEXPONENT1,
        DOT_PRODUCT1,
	RANDOM_SEED1,
	SET_EXPONENT1,
	SYSTEM_CLOCK1,
	DATE_AND_TIME1,
	RANDOM_NUMBER1,
	SELECTED_INT_KIND1,
	SELECTED_REAL_KIND1
